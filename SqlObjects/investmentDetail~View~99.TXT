create view dbo.investmentDetail as 
select i.id as investmentLink,
 g.date,
 g.sourceKey1 as controlNumber,
 case when sourcetype='4771' and amount > 0 then 'Purchase Check' when sourcetype='4771' and amount < 0 then 'Liquidation Check' when sourcetype='4513' then 'Interest Deposit' else 'Journal' end as activity,
 amount
  from dbo.investmentHeader i, gldetailreports g where g.accountcode=i.bankAccountCode and 
 ((g.amount > 0.00 and g.date >= purchaseDate and (g.date < i.liquidationDate or i.liquidationDate < 1 )) 
 or (g.amount < 0.00 and g.date > purchaseDate and (g.date <= i.liquidationDate or i.liquidationDate < 1 )))
