create function dbo.dirFileSize(
 @pathAndFileName varchar(max)
) returns BIGINT as
begin

 DECLARE
  @OLEResult INT,
  @FS INT,
  @FileID INT,
  @size BIGINT

 EXEC @OLEResult = sp_OACreate 'Scripting.FileSystemObject', @FS OUT
 EXEC @OLEResult = sp_OAMethod @FS, 'GetFile', @FileID OUT, @pathAndFileName
 EXEC @OLEResult = sp_OAGetProperty @FileID, 'Size', @size OUT

 return @size

end