CREATE procedure [dbo].[assessmentInvoice](@assessmentId int)
as

begin

 declare 
  @slink varchar(15)


--  begin transaction
  exec dbo.assessReferenceCRUD @assessmentId
  exec dbo.taxrollInvoiceCRUD @assessmentId, 0, 'S'
--   exec dbo.taxRollAddressInsert @assessmentId  TODO : add addresses for assessments
  
  select @slink = slink from dbo.taxrollCheck(@assessmentId,'S')

  if dbo.glPostCheck(@slink) = 0
   begin
--    commit transaction
    select '@code=0;@message=OK;'
   end
  else
   begin 
--    rollback transaction
    select '@code=1;@message=Assessment failed to process correctly, Contact Support. (as.inv);'
   end


end

