create function dbo.docBRWDecoder( 
 @brwId int
) returns @rt table(
 documentName varchar(50),
 processCode varchar(50)
) as
begin

 declare
  @retval varchar(max),
  @idSwitch int,
  @batchId int,
  @processCode varchar(50),
  @documentName varchar(50)
 
 select
  @idSwitch = left( cast(@brwId as varchar), 1),
  @batchId = substring( cast(@brwId as varchar), 2, 20)

  if @idSwitch = 9
   insert @rt
   select
    documentName,
    processCode
   from documentProcessing where id = @batchId 

  if @idSwitch = 8
   insert @rt
   select
    documentName,
    stamp
   from taxrollDetail where id = @batchId
 
 return

end