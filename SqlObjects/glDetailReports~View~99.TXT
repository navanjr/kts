create view dbo.glDetailReports as

select
 a.fpCode,a.fpDesc,
 a.accountCode,
 c.accountDesc,
 amount,
 debit = case when amount > 0.00 then cast(amount as varchar) else '' end,
 credit = case when amount < 0.00 then cast(abs(amount) as varchar) else '' end,
 date,
 slink,
 sourceKey1 = b.key1,
 sourceDate = b.key2, 
 sourceKey3 = b.key3,
 sourceType = cast(b.typ as varchar(15)),
 sourcea18 = b.a18,
 c.accountType,
 a.contraId,
 a.slink2,
 a.id,
 a.accountId,
 a.sourceCode,
 a.bsId,
 c.auditReportGroup,
 c.reportOrder
from gldetail a, object b, glaccounts c
where
 a.slink = 'o'+cast(b.id as varchar)
-- and b.typ in (4512,4513,4502,4522,4771)
 and a.accountId = c.accountId

union all

select
 a.fpCode,a.fpDesc,
 a.accountCode,
 c.accountDesc,
 amount,
 debit = case when amount > 0.00 then cast(amount as varchar) else '' end,
 credit = case when amount < 0.00 then cast(abs(amount) as varchar) else '' end,
 date,
 slink,
 sourceKey1 = cast(b.item as varchar),
 sourceDate = cast(b.postdate as varchar(50)), 
 sourceKey3 = b.typ,
 sourceType = 'Invoice',
 sourcea18 = c.a18,
 c.accountType,
 a.contraId,
 a.slink2,
 a.id,
 a.accountId,
 a.sourceCode,
 a.bsId,
 c.auditReportGroup,
 c.reportOrder
from gldetail a, invoices b, glaccounts c
where
 a.slink = 't'+cast(b.id as varchar)
 and a.accountId = c.accountId

union all

select
 a.fpCode,a.fpDesc,
 a.accountCode,
 c.accountDesc,
 amount,
 debit = case when amount > 0.00 then cast(amount as varchar) else '' end,
 credit = case when amount < 0.00 then cast(abs(amount) as varchar) else '' end,
 date,
 slink,
 sourceKey1 = d.key1,
 sourceDate = d.key2, 
 sourceKey3 = d.key3,
 sourceType = cast(d.typ as varchar(15)),
 sourcea18 = d.a18,
 c.accountType,
 a.contraId,
 a.slink2,
 a.id,
 a.accountId,
 a.sourceCode,
 a.bsId,
 c.auditReportGroup,
 c.reportOrder
from gldetail a, receiptLink b, object d, glaccounts c
where
 a.slink = 'l'+cast(b.id as varchar)
 and d.id = b.receiptId
 and a.accountId = c.accountId

union all

select
 a.fpCode,a.fpDesc,
 a.accountCode,
 c.accountDesc,
 amount,
 debit = case when amount > 0.00 then cast(amount as varchar) else '' end,
 credit = case when amount < 0.00 then cast(abs(amount) as varchar) else '' end,
 date,
 slink,
 sourceKey1 = d.key1,
 sourceDate = d.key2, 
 sourceKey3 = d.key3,
 sourceType = cast(d.typ as varchar(15)),
 sourcea18 = d.a18,
 c.accountType,
 a.contraId,
 a.slink2,
 a.id,
 a.accountId,
 a.sourceCode,
 a.bsId,
 c.auditReportGroup,
 c.reportOrder
from gldetail a, journalLink b, object d, glaccounts c
where
 a.slink = 'j'+cast(b.id as varchar)
 and d.id = b.receiptId
 and a.accountId = c.accountId