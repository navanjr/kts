create function dbo.docBRWDecoder( 
 @brwId int
) returns @rt table(
 documentName varchar(50),
 processCode varchar(50),
 reportName varchar(50)
) as
begin

 declare
  @idSwitch int,
  @batchId int
 
 select
  @idSwitch = left( cast(@brwId as varchar), 1),
  @batchId = substring( cast(@brwId as varchar), 2, 20)

  if @idSwitch = 9
   insert @rt
   select
    documentName,
    processCode,
    null
   from documentProcessing where id = @batchId 

  if @idSwitch = 8
   insert @rt
   select
    documentName,
    stamp,
    null
   from taxrollDetail where id = @batchId
  
  update a set
   a.reportName = o.key3
  from @rt a, object o  
  where o.typ = 4900
   and a.documentName = o.key1

 return

end