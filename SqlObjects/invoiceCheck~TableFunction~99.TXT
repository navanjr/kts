create function dbo.invoiceCheck(@invoiceId int) returns @rt table(
 due money,
 arAccountId int,
 postDate int
)
begin
 
 declare @slink varchar(15) = 't' + cast(@invoiceId as varchar)

 insert @rt
 select 
  dbo.invoiceTotalAR(@invoiceId),
  max(a.accountId),
  c.postDate 
 from glDetail a with (NOLOCK), glAccounts b, invoices c with (NOLOCK)
 where a.accountId = b.accountId
  and a.slink=@slink
  and c.id = @invoiceId
  and b.accountType = 'RECEIVABLE'
 group by b.accountType, c.postDate
 
 return
end