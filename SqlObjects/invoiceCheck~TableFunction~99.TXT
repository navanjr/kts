create function dbo.invoiceCheck(@invoiceId int) returns @rt table(
 due money,
 arAccountId int,
 postDate int
)
begin
 
 declare @slink varchar(15) = 't' + cast(@invoiceId as varchar)

 insert @rt
 select 
  dbo.invoiceTotalAR(@invoiceId),
  a.accountId,
  c.postDate 
 from glDetail a, glAccounts b, invoices c
 where a.accountId = b.accountId
  and left(a.slink,1)='t' and dbo.slinkId(a.slink)=c.id
  and c.id = @invoiceId
  and b.accountType = 'RECEIVABLE'
 group by a.accountId, c.postDate
 
 return
end