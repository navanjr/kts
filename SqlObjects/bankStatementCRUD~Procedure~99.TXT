create procedure dbo.bankStatementCRUD (@date varchar(20)) as 

begin

declare @datetime datetime = dbo.date1(@date)
declare @firstDay varchar(20),
        @lastDay varchar(20)

select @firstDay = dbo.clariondate(dateadd(month, datediff(month, 0, @datetime), 0))
select @lastDay = dbo.clariondate(dateadd(month, datediff(month, 0, @datetime) + 1, 0) - 1)

insert object (typ,link1,key1,key2,a1,a2,k2)
 select 4780,accountid,accountcode,accountdesc,@firstDay,@lastDay,left(cast(999999-cast(@firstDay as int) as varchar)+accountcode,29) 
  from glaccounts 
  where accounttype in (select accounttype from dbo.glbankfundtypes('BANK') where accounttype <> 'SUSPENSE') 
   and accountCode not in (select key1 from object where typ=4780 and a1=@firstDay)

end