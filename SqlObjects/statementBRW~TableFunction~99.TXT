create function dbo.statementBRW(@slink varchar(15), @showGL int) returns 
@rt table(
 ord varchar(50),
 id int,
 description varchar(50), 
 subdescription varchar(50), 
 amount money,
 alternateDescription varchar(50)
)
begin


 insert @rt
  select 'aa',cast('9'+cast(id as varchar) as int)*-1,description,lower(subDescription),amount,dbo.glDetailReplaceDistrictWRateSF(sourceCode,description) 
   from receiptDetail where slink = @slink 
  
 insert @rt
  select 'aa',cast('9'+cast(id as varchar) as int)*-1,description,'',amount,dbo.glDetailReplaceDistrictWRateSF(sourceCode,description) 
   from receiptDetail
     where slink in (select 't' + CAST(i.id as varchar) from invoices i,invoices p where SUBSTRING(@slink,2,14)=i.invoiceId and i.invoiceId=p.id and i.postDate = p.postDate)


 if exists(select * from dbo.paid where slink = @slink)
 begin
  insert @rt
  select 'ba',0,'','',0,''
  insert @rt
  select 'bb',0,'Payment(s)','',0,''
  insert @rt
  select 'bc',cast('8'+cast(id as varchar) as int)*-1,'   '+paycode,checkno,amount*-1,'' from dbo.paid where slink = @slink
 end


 return
end