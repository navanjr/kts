create function dbo.split (
 @RowData nvarchar(max),
 @delimeter nvarchar(max) 
) returns @rt table(
 id int identity(1,1),
 data nvarchar(max)
) 
as
begin 

 declare
  @Iterator int = 1,
  @FoundIndex int

 if @delimeter is null
 begin

  while len(@rowData) > 0
  begin
   insert @rt (data) select left(@rowData,1)
   if len(@rowData) = 1
    break
   set @rowData = substring(@rowData,2,len(@rowdata))
  end

 end
 else
 begin

  set @FoundIndex = CHARINDEX(@Delimeter,@RowData)

    WHILE (@FoundIndex>0)
    BEGIN
        INSERT INTO @rt (data)
        SELECT 
            Data = LTRIM(RTRIM(SUBSTRING(@RowData, 1, @FoundIndex - 1)))

        SET @RowData = SUBSTRING(@RowData,
                @FoundIndex + DATALENGTH(@Delimeter) / 2,
                LEN(@RowData))

        SET @Iterator = @Iterator + 1
        SET @FoundIndex = CHARINDEX(@Delimeter, @RowData)
    END
    
    INSERT INTO @rt (Data)
    SELECT Data = LTRIM(RTRIM(@RowData))

 end

 return
end