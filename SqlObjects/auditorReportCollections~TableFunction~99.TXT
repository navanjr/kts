create function dbo.auditorReportCollections(@begindate varchar(15),@enddate varchar(15)) 
returns @rt table(
 auditorReportGroup varchar(50),
 auditReportGroup varchar(60),
 apportionOut money,
 reportOrder varchar(60)
)

as 
begin

declare @wtdetail table(auditorReportGroup varchar(60),auditReportGroup varchar(60),amount money,reportOrder varchar(60))


declare @wttypes table(sourceType varchar(60),auditorReportGroup varchar(60),detail varchar(60))


insert @wttypes
select * from dbo.journalTypes()
insert @wttypes
select * from dbo.paymentTypes()


insert @wtdetail
select auditorReportGroup,case when auditReportGroup > ' 0' then auditReportGroup else accountDesc end,amount,reportOrder from gldetailreports g, @wttypes w
where sourceDate >= @beginDate 
and sourceDate <= @endDate
and accountType in (select accountType from dbo.glBankFundTypes('FUND'))
and accountCode in (select accountCode from glaccounts where bsSummary like '%Ad V%')
and g.sourcea18 = w.sourceType
and auditorReportGroup = 'Collections'

insert @rt
select auditorReportGroup,auditReportGroup,sum(amount),max(reportOrder) as amount from @wtdetail group by auditorReportGroup,auditReportGroup


return
end