create function dbo.getLegalDescriptionArchive(@itemNumber numeric(7,1), @taxyear int) returns varchar(max)
as
begin
 declare @ret varchar(max)
  
 if exists (select * from adtax where realtaxyear = @taxyear and itemnumber = @itemNumber)
  select top 1 @ret = LEGALDESCRIPTION from adtax where realtaxyear = @taxyear and itemnumber = @itemNumber
 else 
  select top 1 @ret = LEGALDESCRIPTION from adtaxarchive where realtaxyear = @taxyear and itemnumber = @itemNumber

 return @ret

end