create view dbo.glAccounts as
select 
 id as accountId,
 key1 as accountCode,
 key2 as accountDesc,
 key3 as code,
 a1 as accountType,
 a4 as bsSummary,
 a8 as targetAccountCode,
 link1 as targetAccountId,
 subord = case a1
  when 'SOURCE' then 'A'
  when 'RECEIVABLE' then 'B'
  when 'FUND' then 'C'
  else 'Z'
 end,
 a9 as  aptabletype,
 a10 as appilottable,
 a11 as apyear,
 a12 as apdistrict,
 a13 as aprate,
 a14 as appoptype,
 a15 as accountBalance,
 a16 as accountOrigin,
 e1 as rateData,
 a6 as bankAccount,
 a20 as reportOrder,
 b1 as monthEndCategory,
 b2 as monthEndColumn,
 cast(b3 as int) as inActive,
 b4 as auditReportGroup,
 a19 as SECA,
 a18,
 b5 as ledgerGroup,
 b6 as BankName,
 b15 as schoolFund,
 case when link3>0 then (select o.key2 from object o where o.typ=4509 and o.id=object.link3) else '' end as BankLocation,
 case when b7 > ' 0' then b7 else key1 end as interestToAccountCode,
 b7,
 b8 as financialGroup,
 c1 as showOnBKD,
 c3 as form308,
 case
  when b5 > '  0' then b5                              -- ledgerGroup
  when a1 in (select key3 from object where typ=4701) then dbo.getPsAccountCode(a1, key1)  -- accounttype coded accountCode
  else key1                                            -- accountCode
 end as psAccountCode,
 case when c2='1' then 'CDARS' else '' end as CDARS,
 b11 as targetACR
from object where typ = 4701
