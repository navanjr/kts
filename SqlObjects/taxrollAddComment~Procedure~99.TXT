create procedure dbo.taxrollAddComment(
 @invoiceId int,
 @initials varchar(5)
) as 
begin

 declare @privateInt varchar(1) = '0'

-- check the site setting
 if dbo.settingsF('site.commentsDefaultToPrivate','FALSE') = 'TRUE'
  set @privateInt = '1'

-- check the user/group settings
 if dbo.readstring('@privateComments=',dbo.myOptions()) = '1'
  set @privateInt = '1'

 if @invoiceId < 9000000
  begin
   insert into object (typ,key1,key2,key3,a1,a2,attributes,a4,type1)
   select 4002,
       item,
       parcel,
       name,
       taxyear,
       dbo.clariondate(getdate()),
       @initials,
       @privateInt,
       @invoiceId
   from invoices where id = @invoiceId
  end
 else
  begin
   if @invoiceId > 9000000 and @invoiceId < 10000000
    begin
     insert into object (typ,key1,key2,key3,a1,a2,attributes,a4,type2)
     select 4002,
       ITEMNUMBER,
       FULLPIDNUMBER,
       ownername,
       realtaxyear,
       dbo.clariondate(getdate()),
       @initials,
       @privateInt,
       Id
     from adtax where id = @invoiceId-9000000

    end


   if @invoiceId > 10000000
    begin
     insert into object (typ,key1,key2,key3,a1,a2,attributes,a4,type2)
     select 4002,
       ITEMNUMBER,
       FULLPIDNUMBER,
       ownername,
       realtaxyear,
       dbo.clariondate(getdate()),
       @initials,
       @privateInt,
       Id
     from adtaxarchive where id = @invoiceId-10000000

    end

  end

end