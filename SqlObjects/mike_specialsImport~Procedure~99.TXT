create proc dbo.mike_specialsImport(
 @taxyear varchar(4),
 @code varchar(50),
 @noMike varchar(5) = 'FALSE'
) as
begin
 
 declare @tally int
 
 declare @wt table(itemNumber numeric(7,1))

 insert @wt select itemNumber from adtax where realtaxyear = @taxyear and origin = @code
 
 select @tally = count(*) from @wt
 exec dbo.logit @@procid, 'Started .... @taxyear', @taxyear, '@code', @code, '@tally', @tally, '@noMike', @noMike 
 

 if @code = 'mike_taxroll_special' 
  insert adtax 
           ([RECORDTYPE],[FULLPIDNUMBER],[ITEMNUMBER],[REALTAXYEAR],[OWNERNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP1],[ZIP2]
           ,[ORGSCHOOLDISTRICTMAIN],[SCHOOLDISTRICTMAIN],[ORGSCHOOLDISTRICTTAXRATE],[SCHOOLDISTRICTTAXRATE]
           ,[MORTGAGECODE],[ACRES],[MFGHOMEASSESSED],[GROSSASSESSED],[EXEMPTION1],[NETASSESSEDVALUE],[TOTALTAXRATE],[ORIGINALTOTALDUE],[TOTALDUE],[BALANCEDUE]
           ,[CERTIFICATENUMBER],[LEGALDESCRIPTION],	[ADDITIONNUMBER],[TOWNSHIPBLOCK],[RANGELOT],[SECTIONNUMBER],[QTRSECTIONNUMBER],[PARCELNUMBER],[PROPERTYSPLIT]
           ,[PIDSORTNUMBER],[BUSINESSNAME],[ZIP3],[COUNTRY],[FIREDISTRICT],[OWNERNUMBER],[LOTS]
           ,[FREEPORTEXEMPTION],[BASEEXEMPTION],[DBLEXEMPTION],[EXEMPTION2],[EXEMPTION3],[PAIDOFFDATE],[PROPERTYLIENCODE1],[PROPERTYLIENAMOUNT1]
           ,[PROPERTYLIENCODE2],[PROPERTYLIENAMOUNT2],[LASTTRANDATE],[TAXCORRECTIONDATE],[TAXCORRECTIONINITIALS],[FLAG1],[FLAG2],[FLAG3],[pertyp],proploc,[mort_cd]
           ,[morleg],[bankrupt],[treamort],[chg_asmt],[cur_adr],[trcode],[kpsc_schn],MiscAssessed,
LandAssessed,
ImprovedAssessed,
[origin])
  select *,@code from mike_taxroll where realtaxyear = @taxyear and recordtype = 'O' and pertyp != 'F'
   and itemNumber not in (select itemNumber from @wt)

 if @code = 'mike_taxroll_fire' 
  insert adtax 
           ([RECORDTYPE],[FULLPIDNUMBER],[ITEMNUMBER],[REALTAXYEAR],[OWNERNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP1],[ZIP2]
           ,[ORGSCHOOLDISTRICTMAIN],[SCHOOLDISTRICTMAIN],[ORGSCHOOLDISTRICTTAXRATE],[SCHOOLDISTRICTTAXRATE]
           ,[MORTGAGECODE],[ACRES],[MFGHOMEASSESSED],[GROSSASSESSED],[EXEMPTION1],[NETASSESSEDVALUE],[TOTALTAXRATE],[ORIGINALTOTALDUE],[TOTALDUE],[BALANCEDUE]
           ,[CERTIFICATENUMBER],[LEGALDESCRIPTION],	[ADDITIONNUMBER],[TOWNSHIPBLOCK],[RANGELOT],[SECTIONNUMBER],[QTRSECTIONNUMBER],[PARCELNUMBER],[PROPERTYSPLIT]
           ,[PIDSORTNUMBER],[BUSINESSNAME],[ZIP3],[COUNTRY],[FIREDISTRICT],[OWNERNUMBER],[LOTS]
           ,[FREEPORTEXEMPTION],[BASEEXEMPTION],[DBLEXEMPTION],[EXEMPTION2],[EXEMPTION3],[PAIDOFFDATE],[PROPERTYLIENCODE1],[PROPERTYLIENAMOUNT1]
           ,[PROPERTYLIENCODE2],[PROPERTYLIENAMOUNT2],[LASTTRANDATE],[TAXCORRECTIONDATE],[TAXCORRECTIONINITIALS],[FLAG1],[FLAG2],[FLAG3],[pertyp],proploc,[mort_cd]
           ,[morleg],[bankrupt],[treamort],[chg_asmt],[cur_adr],[trcode],[kpsc_schn],MiscAssessed,
LandAssessed,
ImprovedAssessed,
[origin])
  select *,@code from mike_taxroll where realtaxyear = @taxyear and recordtype = 'O' and pertyp = 'F'
   and itemNumber not in (select itemNumber from @wt)

 if @code = 'mike_taxroll' and @noMike = 'FALSE' 
  insert adtax 
           ([RECORDTYPE],
[FULLPIDNUMBER],
[ITEMNUMBER],
[REALTAXYEAR],
[OWNERNAME],
[ADDRESS1],
[ADDRESS2],
[ADDRESS3],
[CITY],[STATE],[ZIP1],[ZIP2],
[ORGSCHOOLDISTRICTMAIN],
[SCHOOLDISTRICTMAIN],
[ORGSCHOOLDISTRICTTAXRATE],
[SCHOOLDISTRICTTAXRATE],
[MORTGAGECODE],
[ACRES],
[MFGHOMEASSESSED],
[GROSSASSESSED],
[EXEMPTION1],
[NETASSESSEDVALUE],
[TOTALTAXRATE],
[ORIGINALTOTALDUE],
[TOTALDUE],
[BALANCEDUE],
[CERTIFICATENUMBER],
[LEGALDESCRIPTION],	
[ADDITIONNUMBER],
[TOWNSHIPBLOCK],
[RANGELOT],
[SECTIONNUMBER],
[QTRSECTIONNUMBER],
[PARCELNUMBER],
[PROPERTYSPLIT],
[PIDSORTNUMBER],
[BUSINESSNAME],
[ZIP3],
[COUNTRY],
[FIREDISTRICT],
[OWNERNUMBER],
[LOTS],
[FREEPORTEXEMPTION],
[BASEEXEMPTION],
[DBLEXEMPTION],
[EXEMPTION2],
[EXEMPTION3],
[PAIDOFFDATE],
[PROPERTYLIENCODE1],
[PROPERTYLIENAMOUNT1],
[PROPERTYLIENCODE2],
[PROPERTYLIENAMOUNT2],
[LASTTRANDATE],
[TAXCORRECTIONDATE],
[TAXCORRECTIONINITIALS],
[FLAG1],
[FLAG2],
[FLAG3],
[pertyp],
proploc,
[mort_cd],
[morleg],
[bankrupt],
[treamort],
[chg_asmt],
[cur_adr],
[trcode],
[kpsc_schn],
MiscAssessed,
LandAssessed,
ImprovedAssessed,
[origin])
  select *,@code from mike_taxroll where realtaxyear = @taxyear and recordtype != 'O'
   and itemNumber not in (select itemNumber from @wt)
--72
 if @code = 'mike_taxroll' and @noMike = 'TRUE' 
  insert adtax 
           ([RECORDTYPE],[FULLPIDNUMBER],[ITEMNUMBER],[REALTAXYEAR],[OWNERNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP1],[ZIP2]
           ,[ORGSCHOOLDISTRICTMAIN],[SCHOOLDISTRICTMAIN],[ORGSCHOOLDISTRICTTAXRATE],[SCHOOLDISTRICTTAXRATE]
           ,[MORTGAGECODE],[ACRES],[MFGHOMEASSESSED],[GROSSASSESSED],[EXEMPTION1],[NETASSESSEDVALUE],[TOTALTAXRATE],[ORIGINALTOTALDUE],[TOTALDUE],[BALANCEDUE]
           ,[CERTIFICATENUMBER],[LEGALDESCRIPTION],	[ADDITIONNUMBER],[TOWNSHIPBLOCK],[RANGELOT],[SECTIONNUMBER],[QTRSECTIONNUMBER],[PARCELNUMBER],[PROPERTYSPLIT]
           ,[PIDSORTNUMBER],[BUSINESSNAME],[ZIP3],[COUNTRY],[FIREDISTRICT],[OWNERNUMBER],[LOTS]
           ,[FREEPORTEXEMPTION],[BASEEXEMPTION],[DBLEXEMPTION],[EXEMPTION2],[EXEMPTION3],[PAIDOFFDATE],[PROPERTYLIENCODE1],[PROPERTYLIENAMOUNT1]
           ,[PROPERTYLIENCODE2],[PROPERTYLIENAMOUNT2],[LASTTRANDATE],[TAXCORRECTIONDATE],[TAXCORRECTIONINITIALS],[FLAG1],[FLAG2],[FLAG3],[pertyp],proploc,[mort_cd]
           ,[morleg],[bankrupt],[treamort],[chg_asmt],[cur_adr],[trcode], [kpsc_schn], MiscAssessed, LandAssessed, ImprovedAssessed,[origin])
  select 
            [RECORDTYPE],[FULLPIDNUMBER],[ITEMNUMBER],[REALTAXYEAR],[OWNERNAME],[ADDRESS1],[ADDRESS2],[ADDRESS3],[CITY],[STATE],[ZIP1],[ZIP2]
           ,[ORGSCHOOLDISTRICTMAIN],[SCHOOLDISTRICTMAIN],[ORGSCHOOLDISTRICTTAXRATE],[SCHOOLDISTRICTTAXRATE]
           ,[MORTGAGECODE],[ACRES],[MFGHOMEASSESSED],[GROSSASSESSED],[EXEMPTION1],[NETASSESSEDVALUE],[TOTALTAXRATE],[ORIGINALTOTALDUE],[TOTALDUE],[BALANCEDUE]
           ,[CERTIFICATENUMBER],[LEGALDESCRIPTION],	[ADDITIONNUMBER],[TOWNSHIPBLOCK],[RANGELOT],[SECTIONNUMBER],[QTRSECTIONNUMBER],[PARCELNUMBER],[PROPERTYSPLIT]
           ,[PIDSORTNUMBER],[BUSINESSNAME],[ZIP3],[COUNTRY],[FIREDISTRICT],[OWNERNUMBER],[LOTS]
           ,[FREEPORTEXEMPTION],[BASEEXEMPTION],[DBLEXEMPTION],[EXEMPTION2],[EXEMPTION3],[PAIDOFFDATE],[PROPERTYLIENCODE1],[PROPERTYLIENAMOUNT1]
           ,[PROPERTYLIENCODE2],[PROPERTYLIENAMOUNT2],[LASTTRANDATE],[TAXCORRECTIONDATE],[TAXCORRECTIONINITIALS],[FLAG1],[FLAG2],[FLAG3],'','',''
           ,'','','','','','','',MiscAssessed,LandAssessed,ImprovedAssessed,
@code from mike_taxroll where realtaxyear = @taxyear and recordtype != 'O'
   and itemNumber not in (select itemNumber from @wt)



 return
end