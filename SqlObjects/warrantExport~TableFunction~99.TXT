create function dbo.warrantExport(@begindate varchar(20),
        @enddate varchar(20))

returns @rt table(
slink varchar(20),
accountCode varchar(60),
fiscalYear varchar(20),
fund varchar(50),
warNo varchar(50),
payDate varchar(50),
amount money,
interest money,
payNo varchar(50)
)
as 
begin
insert @rt
select slink,accountCode,'','',foreignNumber,dbo.date112(contraPostDate),naturalAmount,0.00,contraControlNumber from dbo.paymentreports('Warrant',@enddate,'TRUE')
 where contraPostDate >= @beginDate
   and contraPostDate <= @enddate
   and paymentType='warrant'

update r set fiscalYear = o.c10 
  from @rt r, object o 
   where dbo.slinkId(r.slink)=o.id

update r set fund = c.key2
 from @rt r, glaccounts a, object c
  where r.accountCode=a.accountCode
    and c.typ = 4704
    and c.a2=a.targetaccountCode

return
end
