create function dbo.targetFundInvoice(@invoiceId int) returns @rt table(accountCode varchar(50),apportionPercent money) 
as
begin 
declare @fundCode varchar(50)

select top 1 @fundCode=fundcode from receiptdetail where slink = 't'+cast(@invoiceId as varchar(15)) order by amount desc

insert @rt
select * from dbo.targetFund(@fundCode) order by apportionpercent desc

return
end
