create function dbo.mike_taxFeeTF(
 @taxyear varchar(4)
) returns @rt table(
 code varchar(50),
 value varchar(50)
) as
begin

 insert @rt
 select 'mike_fee',
  convert(varchar, count(*),1) + ' - ' + convert(varchar, cast(sum(amount) as money),1)
 from mike_fee where taxyear + right('000000' + cast(cast(itm_nbr as int) as varchar),6) in (select mikeFeeLink from dbo.invoiceAll where taxyear = @taxyear)
  and amount != 0

 insert @rt
 select 'subInvoice',
  convert(varchar, count(*),1) + ' - ' + convert(varchar, cast(sum(invoiceDue) as money),1)
 from invoices where taxyear = @taxyear and origin in ('mike_fee','state_fee')

 insert @rt
 select 'state_fee',
  convert(varchar, count(*),1) + ' - ' + convert(varchar, cast(sum(amount) as money),1)
 from dbo.state_tax_fee() where cast(taxyear as varchar(4)) = @taxyear
  and amount != 0
 

 return

end