CREATE function dbo.dailydata(@theDate int, @days int) returns 
@rettable table (
 id int,
 ord varchar(10),
 rowstring varchar(250)
)
begin
 insert @rettable
  select 0,'  ',''

 insert @rettable
  select 0,'AA','   Collections'

 insert @rettable
  select 0,'AB',replicate('-',70)

 insert @rettable 
 select
  c.id * -1, 
  'AZ',
  '   ' + dbo.padRight(c.template,' ',30)
  + dbo.padLeft(cast(min(key1) as varchar),0,5)
  + ' - ' + dbo.padLeft(cast(max(key1) as varchar),0,5)
  + ' ' + dbo.padLeft(cast(count(distinct sourceId) as varchar),' ',4)
  + dbo.padLeft(convert(varchar,sum(a.amount),1),' ',16)
 from glDetail a, object b, template c 
 where a.sourceId = b.id and b.typ = c.id
   and a.date between @theDate and @thedate + @days
   and a.amount > 0
 group by c.id, c.template

 return

end











<<<<<<< HEAD

=======
>>>>>>> matt
