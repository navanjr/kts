CREATE function dbo.dailydata(@theDate int, @days int, @filterString varchar(50)) returns 
@rt table (
 id int,
 ord varchar(250),
 rowstring varchar(250),
 glBalanceString varchar(50),
 rowstring1 varchar(250),
 sourceNo varchar(50),
 recordCnt varchar(50),
 sourceAmt varchar(50),
 brwBGColor int
)
begin
 declare @showDetail table(id int)
 insert @showDetail select 4522

 declare @rawData table(
  amount money,
  tname varchar(50),
  typ int,
  num varchar(50),
  slink varchar(15),
  ord char(1)
 )

 -- get the raw data from glDetail, this yields receipts, vouchers, deposits

-- Collections
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataCollections(@theDate, @days, 'F', @filterString)

-- Deposits & Disbursments
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataDeposits(@theDate, @days, 'G', @filterString)

-- Vouchers
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataPayments('Official Voucher','Official',@theDate, @days, 'H', @filterString)

-- Cancelled Vouchers
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataPayments('Cancel Voucher','Official',@theDate, @days, 'H', @filterString)

-- Journal
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataJournal(@theDate, @days, 'I', @filterString)

-- Warrants
 if substring(@filterString,2,1) = '1'
  insert @rt 
  select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataPayments('Treasurers Check|Paid Warrant','Fund',@theDate, @days, 'J', @filterString)
    
-- Miscellaneous Payments
if substring(@filterString,2,1) = '1'
 insert @rt 
 select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataPayments('Miscellaneous|Miscellaneous Payments','Fund',@theDate, @days, 'K', @filterString) order by ord

-- Miscellaneous Deposits
if substring(@filterString,2,1) = '1'
 insert @rt 
 select id*-1,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataMiscDeposit('Fund',@theDate, @days, 'L', @filterString) order by ord

-- Suspense
if substring(@filterString,1,1) = '1'
begin

 insert @rt 
 select id,ord,rowString,glBalanceString,rowString1,sourceNo,recordCnt,sourceAmt,brwBGColor from dbo.dailyDataSuspense(@theDate, @days, 'C',@filterString) order by ord

--Pending Deposits
 insert @rt 
 select id,ord,rowstring,glBalanceString,rowstring1,sourceNo,recordCnt,sourceAmt,brwBGColor
 from dbo.dailyDataPendingDeposits(@theDate)

end

 return

end