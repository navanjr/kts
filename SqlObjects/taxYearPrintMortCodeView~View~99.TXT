create view dbo.taxYearPrintMortCodeView as

select 
 o.id as id,
 -9 as brwid,
 i.TAXYEAR,
 i.printed,
 o.c1 as printSeparateFlag,
 case when isnull(o.c1,'') = '1' then
  o.key3
 -- case when a.treamort > '  0' then cast(a.treamort as varchar) else cast(a.mortgagecode as varchar) end
 else
  'Other Mortgage Code'
 end as mortgageCode,
 a.mortgageCode as adtaxMortgageCode,
 a.treamort as treasMortgageCode,
 o.key3 as treasMortgageName,
 case when isnull(o.c1,'') = '1' then
  o.key1
 else 
  'Grouped'
 end as theRealMortCode
from AdTax a, invoices i, Object o
where a.ID = i.taxrollid and case when a.treamort>'  0' then a.treamort else a.mortgagecode end = o.Key1
 and o.Typ = 4030
