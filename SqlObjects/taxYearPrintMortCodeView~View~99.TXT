create view dbo.taxYearPrintMortCodeView as

select 
 i.TAXYEAR,
 i.printed,
 o.c1 as printSeporateFlag,
 case when a.treamort>'  0' then a.treamort else a.mortgagecode end as mortgageCode
from AdTax a, invoices i, Object o
where a.ID = i.taxrollid and case when a.treamort>'  0' then a.treamort else a.mortgagecode end = o.Key1
 and o.Typ = 4030
