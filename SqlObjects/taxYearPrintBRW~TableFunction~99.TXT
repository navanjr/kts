create function dbo.taxYearPrintBRW( @taxYear varchar(50) ) returns @rt table(
 id int,
 ord varchar(50),
 code varchar(50),
 theRealMortCode varchar(50),
 tally int,
 tallyPrinted int
) as 
begin


-- all invoices
 insert @rt 
 select -1,1,'Total Invoices','',count(*),sum(case when printed > '  0' then 1 else 0 end) from invoices where taxyear = @taxyear

-- mortgage codes
 insert @rt 
 select cast('-9'+cast(max(id) as varchar) as int),2,mortgageCode,max(theRealMortCode),count(*),sum(case when printed > '  0' then 1 else 0 end) from taxYearPrintMortCodeView where taxyear = @taxyear
  group by mortgageCode

 return
end