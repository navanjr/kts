create function dbo.taxCorrectionsSF(@adTaxValue varchar(200),@taxrollId int,@crLabel varchar(50)) returns varchar(50)
as
begin

declare @x varchar(200)


declare @fieldNumber int

select @fieldNumber = case when isnumeric(@crLabel)=1 then cast(@crLabel as int) else 0 end

select top 1 
      @x = fieldData 
    from taxrollCorrections 
   where taxrollId = @taxrollId 
      and fieldNumber = @fieldNumber 
     order by ID desc



if @x is null

select top 1 
      @x = A2 
    from Object 
   where link1 = @taxrollId 
         and TYP=4005 
         and key1 = @crLabel 
     order by ID desc




if @x is null
 
 set @x = rtrim(@adTaxValue)

return @x

end