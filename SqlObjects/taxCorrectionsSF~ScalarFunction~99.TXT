create function dbo.taxCorrectionsSF(@adTaxValue varchar(2000),@taxrollId int,@crLabel varchar(50)) returns varchar(2000)
as
begin
declare @x varchar(2000)
declare @fieldNumber int
select @fieldNumber = case when isnumeric(@crLabel)=1 then cast(@crLabel as int) else 0 end
select top 1 
      @x = fieldData 
    from taxrollCorrections 
   where taxrollId = @taxrollId 
      and fieldNumber = @fieldNumber 
     order by ID desc

if @x is null
select top 1 
      @x = A2 
    from Object 
   where link1 = @taxrollId 
         and TYP=4005 
         and key1 = @crLabel 
     order by ID desc

if @x is null
 set @x = rtrim(@adTaxValue)

if @crLabel = '082'
begin
 declare @iCert varchar(50), @parcel varchar(50)
 select @parcel = dbo.taxCorrectionsSF([FULLPIDNUMBER],@taxrollId,'006') from adtax where id=@taxrollId
 select @iCert = a4 from object where typ=4100 and key2='A' and key1=@parcel
 if isnull(@iCert,'') > ''
 begin
  set @x = rtrim(@iCert)
 end 
end

return @x

end