create view dbo.glCollectionAccount as
select 
 a.accountId,
 a.accountCode,
 a.accountDesc,
 a.accountType,
 a.bsSummary as collectionDescription,
 b.key2 as reportOrder,
 case when a.bsSummary='Depository' then isnull((select a1 from object where typ=4601 and a3=a.accountCode),'') else '' end as dptno
from glaccounts a, object b
where a.bsSummary > '  0'
 and a.bsSummary = b.key1
 and b.typ = 4703