create function dbo.bankStatementClearDate(@bsid int) 
 returns int
  as
begin

 declare @statementStart int,
         @statementEnd int,
         @clearDate int


 select 
  @statementStart = a1,
  @statementEnd = a2
  from object where id = @bsId
 
 set 
  @clearDate = 
   case when dbo.clariondate(getdate()) < @statementStart then @statementStart
    when dbo.clariondate(getdate()) > @statementEnd then @statementend
    else dbo.clariondate(getdate()) end

return @clearDate

end