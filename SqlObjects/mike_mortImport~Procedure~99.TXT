create proc dbo.mike_mortImport (
 @mode varchar(50),
 @taxyear varchar(4)
) as 
begin

 declare
  @tally int,
  @log varchar(max) 

if exists(select * from dbo.sysobjects where id = object_id(N'[dbo].[mike_taxroll]') and OBJECTPROPERTY(id, N'IsTable') = 1)
 begin
 
if @mode = 'updatethem'
 begin
  select
   @tally = count(*)
  from adtax a, mike_taxroll b 
  where
   a.itemnumber = b.itemnumber
   and a.REALTAXYEAR = @taxyear
   and b.REALTAXYEAR = @taxyear
   and a.treamort != b.treamort
    
  update a set a.treamort = b.treamort
  from adtax a, mike_taxroll b 
  where
   a.itemnumber = b.itemnumber
   and a.REALTAXYEAR = @taxyear
   and b.REALTAXYEAR = @taxyear
   and a.treamort != b.treamort

  select @log = '@code=1;@tally=' + cast(@tally as varchar) + ';@message=Updated adtax.treamort from mike_taxroll;'
  exec dbo.logit @@procId, @log
  select @log
  return

 end


 if @mode = 'getcount'
 begin
  select
   @tally = count(*)
  from adtax a, mike_taxroll b 
  where
   a.itemnumber = b.itemnumber
   and a.REALTAXYEAR = @taxyear
   and b.REALTAXYEAR = @taxyear
   and a.treamort != b.treamort

  select @log = '@code=1;@tally=' + cast(@tally as varchar) + ';@message=treamort mismatch;'
  exec dbo.logit @@procId, @log
  select @log
  return

  end
 end
end