create function dbo.reportCommentsBRW(
 @reportId int,
 @startDate int,
 @endDate int
) returns @rt table(
 id int,
 display varchar(max),
 section varchar(50),
 asterisk varchar(50),
 origin int,
 ord varchar(50)
) as
begin

 insert @rt
 select
  id,
  '   ' + dbo.date1(key2) + ' - ' + cast(e1 as varchar(max)),
  key3,
  null,
  1,
  key3 + key2
 from object
 where typ = 5064
  and key1 = @reportId
  and key2 between @startDate and @endDate


 declare @wt table(
  id int identity(1,1),
  section varchar(50),
  asterisk varchar(50)
 )
 insert @wt
 select section, null from @rt group by section order by section

 update @wt set asterisk = replicate('*',id)

 insert @rt
 select 0, section, section, asterisk, 2, section from @wt

 return
end