create procedure dbo.glAccountCodeChange( @accountCode varchar(60), @newCode varchar(50) ) as 
begin
 set nocount on
 
 begin transaction
  -- update the account record in object
  update object set
   key1 = @newCode,
   a17 = ''
  where typ = 4701 and key1 = @accountCode

  if @accountCode >'  0'
  begin
   -- Update Target Accounts
   update object set
    a8 = @newCode
   where typ = 4701 and a8 = @accountCode

   -- Update Bank Statements
   update object set
    key1 = @newCode
   where typ = 4780 and key1 = @accountCode

   -- update glDetail
   update glDetail set accountCode = @newCode where accountCode = @accountCode
  end
 commit transaction

end