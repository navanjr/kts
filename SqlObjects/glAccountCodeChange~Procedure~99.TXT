create procedure dbo.glAccountCodeChange( @accountId int, @newCode varchar(50) ) as 
begin
 set nocount on
 
 begin transaction
 
  -- update the account record in object
  update object set
   key1 = @newCode,
   a17 = ''
  where typ = 4701 and id = @accountId

  -- update glDetail
  update glDetail set accountCode = @newCode where accountId = @accountId

 commit transaction

end