create function dbo.taxRateMillageNew(
 @year varchar(50),
 @district varchar(50),
 @rateName varchar(50)
) returns @rt table(
 setId int,
 millageName varchar(50),
 millageAmount varchar(50),
 ord varchar(100)
) as

begin

 insert @rt (millageName,ord) select key1,case when a9 = 'A' then '1' else rtrim(a3) end+rtrim(a4)+rtrim(a5)+rtrim(key1) from object where typ = 4008

 update @rt set
  millageAmount = (select top 1 a2 from object where typ = 4012 and key1 = @district and key2 = @rateName and key3 = @year and a1 = millageName) 

 return
end
