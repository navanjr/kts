create function dbo.glDetailReplaceDistrictWRateSF(@sourceCode varchar(50),@description varchar(50)) returns varchar(50)
	as 
begin

 declare	@r varchar(50),
			@district varchar(50),
			@rate varchar(50)		
select 
	 @district = case when charindex('_',@sourceCode)>0 then  SUBSTRING(@sourceCode,1,CHARINDEX('_',@sourceCode)-1) else @sourceCode end,
	 @rate = case when charindex('_',@sourceCode)>0 then SUBSTRING(@sourceCode,len(SUBSTRING(@sourceCode,1,CHARINDEX('_',@sourceCode)))+1,CHARINDEX('_',right(@sourceCode,len(@sourceCode)-len(SUBSTRING(@sourceCode,1,CHARINDEX('_',@sourceCode)))))-1) else @sourceCode end
	 
select 
	@r = REPLACE(@description,@district,@rate) 

 return @r 
end