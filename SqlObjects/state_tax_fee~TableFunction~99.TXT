create function dbo.state_tax_fee()
 returns @rt table(id int,
  taxyear int,
  itemnumber decimal(7, 1),
  ownername varchar(100),
  fullpidnumber varchar(100),
  feetype varchar(30),
  amount money,
  comment1 varchar(50),
  comment2 varchar(50)
  )
as
begin
insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'MAIL',[MAILINGFEE],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [MAILINGFEE] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'LIEN',[LIENFEE],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [LIENFEE] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'ADVERTISE',[ADVERTISINGFEES],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [ADVERTISINGFEES] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'SPECIAL FEE 1',[SPECIALASSESSMENTFEE1],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [SPECIALASSESSMENTFEE1] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'SPECIAL FEE 2',[SPECIALASSESSMENTFEE2],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [SPECIALASSESSMENTFEE2] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'SPECIAL FEE 3',[SPECIALASSESSMENTFEE3],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [SPECIALASSESSMENTFEE3] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'SPECIAL FEE 4',[SPECIALASSESSMENTFEE4],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [SPECIALASSESSMENTFEE4] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'SPECIAL FEE 5',[SPECIALASSESSMENTFEE5],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [SPECIALASSESSMENTFEE5] <> 0.00

insert @rt
 select [ID],[REALTAXYEAR],[ITEMNUMBER],[OWNERNAME],[FULLPIDNUMBER],'OTHER FEE',[OTHERFEES],[COMMENT1],[COMMENT2]
  from dbo.taxfeeall where [OTHERFEES] <> 0.00

return
end




