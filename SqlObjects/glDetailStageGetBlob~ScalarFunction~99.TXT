create function glDetailStageGetBlob(@id int) returns varchar(500) as
begin

 declare @retval varchar(500), 
         @contraAcountCode varchar(60), 
         @contraId int, 
         @accountId int, 
         @accountType varchar(60), 
         @contraAccountDesc varchar(50), 
         @sourceCode varchar(60),
         @sourceDesc varchar(50)

 select
  @retval = '@accountCode=' + rtrim(accountCode) + ';'
  + '@accountDesc=' + rtrim(accountDesc) + ';'
  + '@amount=' + cast(amount as varchar(50)) + ';'
  + '@accountId=' + cast(accountId as varchar(50)) + ';'
  + '@contraId=' + cast(isnull(contraId,0) as varchar(50)) + ';'
  + '@sourceCode=' + rtrim(isnull(sourceCode,'')) + ';'
  + '@accountType=' + rtrim(isnull(accountType,'')) + ';'
  + '@comment=' + rtrim(isnull(comment2,'')) + ';'
 from gldetailstage where id = @id

 select @sourceCode = sourceCode from gldetailstage where id = @id

 if isnull(@sourceCode,'') > ' 0'
  begin
   select @sourceDesc = accountDesc from glaccounts where accountCode=@sourceCode
   select @retval=@retval+'@sourceDesc=' + rtrim(isnull(@sourceDesc,'')) + ';'
  end

 select @contraId = contraId from gldetailstage where id = @id

 if isnull(@contraId,0) > 0
  begin
   select @contraAcountCode = accountCode, @contraAccountDesc=accountDesc from glaccounts where accountId=@contraId
   select @retval=@retval+'@contraAccountCode=' + rtrim(isnull(@contraAcountCode,'')) + ';'+
                          '@contraAccountDesc=' + rtrim(isnull(@contraAccountDesc,'')) + ';'
  end
 return @retval

end