create procedure dbo.millsCopy( 
 @typ int,
 @fromYear varchar(50),
 @toYear varchar(50)
)
as
begin

 insert object (typ,key1,key2,key3,a1,a2,a18,k2)
 select @typ,@toYear,key2,key3,a1,a2,a18, case when @typ = 4014 then rtrim(@toYear)+rtrim(a2)+rtrim(key2) else left(rtrim(@toYear)+rtrim(key2),29) end
  from object where typ = @typ and key1 = @fromYear and @toYear+key2+a2 not in (select key1+key2+a2 from object where typ = @typ)
 
 return
end