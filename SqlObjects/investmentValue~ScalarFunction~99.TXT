create function dbo.investmentValue(@id int, @enddate int) returns money as
begin
 declare @value money
 select @value = case when key3 < @enddate and key3 > '1' then 0 else isnull((select sum(amount) from gldetail where accountcode = a9 and date <= @enddate and (date<=case when isnumeric(key3)=1 then cast(key3 as int) else 0 end or case when isnumeric(key3)=1 then cast(key3 as int) else 0 end <'1')),0) end 
 from object where id = @id

 return @value
end