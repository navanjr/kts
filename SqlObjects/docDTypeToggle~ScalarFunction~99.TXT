create function dbo.docDTypeToggle(
 @id int,
 @blob varchar(max)
) returns varchar(max) as
begin
 declare @returnMax varchar(max) = ''
 
 if isnull(@blob,'') < '  0' 
  select @blob = isnull(@blob,'') + cast(id as varchar) + ':0|' from dbo.docDTypes('','') 

 declare @wt table(id int,switch int)
 insert @wt select
  id,switch 
 from dbo.docDTypes(@blob,'')

 if exists(select * from @wt where id = @id)
  update @wt set switch = case when switch = 1 then 0 else 1 end where id = @id
 else
  if @id > 0
   insert @wt select @id, 0
  else
   delete @wt where id = abs(@id) 


 select @returnMax = @returnMax + cast(id as varchar) + ':' + cast(switch as varchar) + '|' from @wt order by id
 return @returnMax
end