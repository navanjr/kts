Create view purposeDetail as 
select contraId as receiptId,
  a.accountId,
  b.accountcode as purpose,
  b.accountDesc,
  sum(amount) as amount
  from glDetail a with (NOLOCK), glAccounts b, object r with (NOLOCK) 
 where r.typ=4502 and a.contraId = r.id and a.accountId=b.accountId 
  and accountType in ('PURPOSE')
 group by a.accountId, contraId, b.accountCode, b.accountDesc