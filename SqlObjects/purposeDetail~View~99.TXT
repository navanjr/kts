Create view purposeDetail as 
select contraId as receiptId,
  a.accountId,
  b.accountcode as purpose,
  b.accountDesc,
  sum(amount) as amount
  from glDetail a, glAccounts b 
 where a.accountId=b.accountId 
  and accountType='PURPOSE' 
 group by a.accountId, contraId, b.accountCode, b.accountDesc
