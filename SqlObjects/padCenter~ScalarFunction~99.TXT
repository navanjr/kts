CREATE FUNCTION dbo.padCenter(@MemVar varchar(max), @PadChar char, @Length int)
RETURNS varchar(max)
AS
BEGIN
	
     declare @ReturnValue varchar(max)
     declare @HowManyLeft int
     declare @LeftValue varchar(max)
     declare @RightValue varchar(max)
	
     set @HowManyLeft = @Length - len(@MemVar)
	
     if @HowManyLeft > 0
     begin
          set @LeftValue = ''
          set @RightValue = ''
		
          while (@HowManyLeft > 0)
          begin
               set @LeftValue = @LeftValue + @PadChar
			
               if @HowManyLeft != 1
                    set @RightValue = @RightValue + @PadChar
			
                    set @HowManyLeft = @HowManyLeft - 2
          end
		
          set @ReturnValue = @LeftValue + @MemVar + @RightValue
     end
     else
          set @ReturnValue = @MemVar
	
     return @ReturnValue
	
END