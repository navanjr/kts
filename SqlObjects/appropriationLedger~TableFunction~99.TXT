create function dbo.appropriationLedger(@begindate varchar(20),@enddate varchar(20)) 
returns @rt table(FundDesc varchar(60),
                  accountNumber varchar(60),
                  warrants varchar(50),
                  budget varchar(50),
                  balance varchar(50),
                  ord varchar(250),
                  fiscalYear varchar(20))
as
begin
           
insert @rt
 select 
  fundDesc,
  accountNumber,
  SUM(payments),
  SUM(budget),
  sum(balance),
  right(fiscalYear,2)+fundDesc+accountnumber+'bbb',
  fiscalYear
  from dbo.appropriationLedgerDetail(@begindate,@enddate) group by right(fiscalYear,2),fiscalYear,funddesc,accountNumber

insert @rt
  select 
  fundDesc,
  '',
  SUM(cast(warrants as money)),
  SUM(cast(budget as money)),
  sum(cast(balance as money)),
  right(fiscalYear,2)+fundDesc+'zzzzz'+'ccc',
  fiscalYear from @rt group by right(fiscalYear,2),fiscalYear,FundDesc

insert @rt (FundDesc,ord,fiscalyear)
  select 
  fundDesc,
  right(fiscalYear,2)+fundDesc+'     '+'aaa',fiscalyear from @rt group by right(fiscalYear,2),fiscalYear,FundDesc

insert @rt (FundDesc,ord,fiscalyear)
  select 
  'Fiscal Year: '+fiscalYear,
  right(fiscalYear,2)+'          '+'aa1',fiscalyear from @rt group by right(fiscalYear,2),fiscalYear


update @rt
  set
  warrants = dbo.formatcurr(warrants),
  budget = dbo.formatcurr(budget),
  balance = dbo.formatcurr(balance)
                  

return
end     
