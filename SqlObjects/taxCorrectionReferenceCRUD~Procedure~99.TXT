create procedure [dbo].[taxCorrectionReferenceCRUD](
 @taxrollId int,
 @newInvoiceId int = null output
) as
begin

  declare @newIdWt newIdWt

 -- insert tax reference invoice
   insert invoices ([TAXROLLID],[TYP],[PARCEL],[ITEM],[TAXYEAR],[NAME],[BUSINESSNAME],[POSTDATE],[STATUS],[interestDate],[origin])
   output inserted.id into @newIdWt
   select
    [ID],
    dbo.taxCorrectionsSF([RECORDTYPE],@taxrollId,'010'),
    dbo.taxCorrectionsSF([FULLPIDNUMBER],@taxrollId,'006'),
    dbo.taxCorrectionsSF([ITEMNUMBER],@taxrollId,'008'),
    dbo.taxCorrectionsSF([REALTAXYEAR],@taxrollId,'004'),
    dbo.readstring('@NAME=',dbo.taxRollAddressBlob(Realtaxyear,itemnumber)),
    dbo.readstring('@BUSINESSNAME=',dbo.taxRollAddressBlob(Realtaxyear,itemnumber)),
    dbo.clariondate(getdate()),
    '',
    dbo.clariondate('12/31/' + cast([REALTAXYEAR] as varchar)),
    'Taxroll Correction'
   from adtax where id = @taxrollId

   select @newInvoiceId = max(id) from @newIdWt

   exec dbo.logit @@procid, 'Created new invoice - @newInvoiceId', @newInvoiceId

end