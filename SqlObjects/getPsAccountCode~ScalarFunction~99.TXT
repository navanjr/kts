create function dbo.getPsAccountCode(
 @code varchar(50),
 @default varchar(50)
) returns varchar(50) as
begin
-- this helper function returns the real accountCode from a "code".
-- if the code passed can not yield an accountCode it will return @default

 declare @retval varchar(50)

 select @retval = max(key1) from object where typ = 4701 and key3 = @code

 return coalesce(@retval, @default)

end