create procedure dbo.advanceDate(@receiptType varchar(50),@date int = 0) as

begin

  if @date = 0 
     select @date = dbo.nextbusinessdate(dbo.clariondate(getdate()))

  if @date > 0
     if @receiptType = 'All'

       update object set a17 = @date where typ = 4503 and c1! = '1'

      else
     
       update object set a17 = @date where typ = 4503 and key1 = @receiptType

end