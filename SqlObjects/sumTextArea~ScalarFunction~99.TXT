create function dbo.sumTextArea(
 @data varchar(max)
) returns varchar(50) as
begin
 declare @retvar varchar(50)

 select @retvar = sum(
--  cast(ltrim(rtrim(replace(data,char(10),''))) as money)
  cast(dbo.stripNonNumeric(data) as money)
 )
 from dbo.split(@data,char(13))

 return @retvar
end