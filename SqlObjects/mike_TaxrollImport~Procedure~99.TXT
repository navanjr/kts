create procedure dbo.mike_TaxrollImport as
begin

-- Drpo Mike's taxroll table
 if exists(select * from dbo.sysobjects where id = object_id(N'[dbo].[mike_taxroll]') and OBJECTPROPERTY(id, N'IsTable') = 1)
 begin
  exec dbo.logit @@procid, 'Dropping table mike_taxroll'
  drop table mike_taxroll
 end

 exec dbo.logit @@procid, 'Creating mike_taxroll from VFP Drivers...'

 select 
  a.typ as [RECORDTYPE],
  a.parcel as [FULLPIDNUMBER],
  cast(a.itm_nbr as numeric(7,1)) as [ITEMNUMBER],
  cast(a.taxyear as numeric(5,0)) as [REALTAXYEAR],
  a.name as [OWNERNAME],
  a.addl1 as [ADDRESS1],
  a.addl2 as [ADDRESS2],
  a.addl3 as [ADDRESS3],
  a.city as [CITY],
  a.[state] as [STATE],
  a.zip_1 as [ZIP1],
  a.zip_2 as [ZIP2],
  a.sch_n as [ORGSCHOOLDISTRICTMAIN],
  b.postdist as [SCHOOLDISTRICTMAIN],
  a.sch_c as [ORGSCHOOLDISTRICTTAXRATE],
  a.c_cityc as [SCHOOLDISTRICTTAXRATE],
  0 as [MORTGAGECODE],
  a.acres as [ACRES],
  a.mobile_hm as [MFGHOMEASSESSED],
  cast(a.g_per as money)+cast(a.g_lv as money)+cast(a.g_imp as money) as [GROSSASSESSED],
  cast(a.exemp as numeric(9,0)) as [EXEMPTION1],
  cast(a.net_assd as numeric(8,0)) as [NETASSESSEDVALUE],
  cast(a.levy as numeric(9,7)) as [TOTALTAXRATE],
  cast(a.tax_due as numeric(19,2)) as [ORIGINALTOTALDUE],
  cast(a.ctax_due as numeric(19,2)) as [TOTALDUE],
  cast(a.unpaid as numeric(19,2)) as [BALANCEDUE],
  left(a.cert_asgn,49) as [CERTIFICATENUMBER],
  a.leg_l1+a.leg_l2+a.leg_l3+a.leg_l4+a.leg_l5+a.leg_l6 as [LEGALDESCRIPTION],
  '' as	[ADDITIONNUMBER], 
  '' as	[TOWNSHIPBLOCK], 
  '' as	[RANGELOT], 
  '' as	[SECTIONNUMBER], 
  '' as	[QTRSECTIONNUMBER], 
  '' as	[PARCELNUMBER], 
  '' as	[PROPERTYSPLIT],
  '' as [PIDSORTNUMBER],
  '' as [BUSINESSNAME],
  '' as [ZIP3],
  '' as [COUNTRY],
  '' as [FIREDISTRICT],
  0 as [OWNERNUMBER],
  0 as [LOTS],
  0 as [FREEPORTEXEMPTION],
  0 as [BASEEXEMPTION],
  0 as [DBLEXEMPTION],
  0 as [EXEMPTION2],
  0 as [EXEMPTION3],
  0 as [PAIDOFFDATE],
  '' as [PROPERTYLIENCODE1],
  0 as [PROPERTYLIENAMOUNT1],
  '' as [PROPERTYLIENCODE2],
  0 as [PROPERTYLIENAMOUNT2],
  0 as [LASTTRANDATE],
  0 as [TAXCORRECTIONDATE],
  '' as [TAXCORRECTIONINITIALS],
  '' as [FLAG1],
  '' as [FLAG2],
  '' as [FLAG3],
  a.[pertyp] as [pertyp],
  a.proploc as [proploc],
  a.[mort_cd] as [mort_cd],
  a.[morleg] as [morleg],
  a.[bankrupt] as [bankrupt],
  a.[treamort] as [treamort],
  a.[chg_asmt] as [chg_asmt],
  a.[cur_adr]as [cur_adr],
  a.[trcode] as [trcode],
  a.[c_schn] as [kpsc_schn]
 into mike_taxroll
 FROM dbo.mike_taxrollVFP() a, dbo.mike_taxAppsch01() b
 where a.c_schn=b.sch_n and a.c_cityc=b.city_c and a.taxyear=b.year

 exec dbo.logit @@procid, 'Complete'

--  exec dbo.taxrollImportSpecialAssessmentRates



end