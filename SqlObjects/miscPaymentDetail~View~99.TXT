create view miscPaymentDetail as
select sourcekey1 as PaymentNo,sourcea2 as Payee,sourcedate as issueDate,
   case when amount > 0 then amount else 0.00 end as debitamt,
   case when amount < 0 then amount*-1 else 0 end as creditamt,
   sourcee1 as PaymentComment,
   case when accounttype in (select accounttype from dbo.glbankfundtypes('BOTH')) then 'GL' else 'Detail' end as DetailType,
   *
 from gldetailreports 
 where sourcetype='4771'
   and sourcea18 = 'Miscellaneous'
