@bb1=&Print;
@bbproc1=
 glDaily=;

@glDaily=
 do(4506,getSiteInfo=),
 d1select('select case when settingvalue = ''TRUE'' then ''Warrant'' else ''Treasurers Check|Paid Warrant'' end from settings where settingname=''site.warrantsHitLedgerWhenRegistered'''),
 lcwarrantCode=obj7:d1,
 lcRm=1200,
 lcCw=750,
 lcAw=(lcCw*4)+400,
 lcFont='Arial',
 lcHeaderFontSize=10,
 lcFootY=7400,
 gcSql4790a='select ltrim(rowstring1), sourceNo, sourceAmt, rowType, electronicAmount, otherAmount from dbo.dailydataCollections('&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790b='select rowstring1, sourceNo, sourceAmt, rowType, electronicAmount, otherAmount from dbo.dailydataDeposits('&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gHeader'',''gFooter''/*,''grandTotal''*/) order by ord',
 gcSql4790v='select ltrim(rowstring1), sourceNo, sourceAmt, rowType from dbo.dailydataPayments(''Official Voucher'',''Official'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790tc='select ltrim(rowstring1), sourceNo, sourceAmt, rowType from dbo.dailydataPayments(''Transfer'',''Bank'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790cv='select ltrim(rowstring1), sourceNo, sourceAmt, rowType, ord from dbo.dailydataPayments(''Cancel Voucher'',''Official'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') 
 union all
 select ltrim(rowstring1), sourceNo, sourceAmt, rowType, ord from dbo.dailydataPayments(''Void Voucher'',''Official'','&gcStartDate&','&gcDays&',''B'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790w='select ltrim(rowstring1), sourceNo, sourceAmt, rowType, ord from dbo.dailydataPayments('''&lcwarrantCode&''',''Fund'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790c='select left(ltrim(rowstring1),40), sourceNo, sourceAmt, rowType, journalIn, journalOut from dbo.dailydataJournal('&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'',''sjHeader'') order by ord',
 gcSql4790m='select left(ltrim(rowstring1),34), sourceNo, sourceAmt, rowType from dbo.dailydataPayments(''Miscellaneous|Miscellaneous Payment'',''Fund'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 gcSql4790md='select ltrim(rowstring1), sourceNo, sourceAmt, rowType from dbo.dailydataMiscDeposit(''Fund'','&gcStartDate&','&gcDays&',''A'','''&gcFilterString&''') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 lcMessage='Pursuant to 19 O.S. 1971, Sec. 15, 119 relating to County Depositories and requiring the deposit daily of all funds collected by the County Treasurer, the following report, hereby declared to be "the abstract which the Treasurer if required to furnish him daily" (19 O.S. 1971, Sec. 644), showing the collections, and deposits and disbursements made together with duplicate receipts, certificates, and deposit slips and original paid and cancelled warrants or vouchers with duplicate checks issued in payment thereof attached, is respectfully submitted, to-wit-',
 lcfootMessage='*Include Transfer Fees remitted by County Clerk''s Warrant to County Treasurers of other counties whether Joint S.D. or not. I, the undersigned County Treasurer fo the County of '&gcCounty&', State of '&gcState&' do hereby certify that the above and foregoing is a full, true and correct statement and report of all collections, deposits, and disbursements made by me on the day and date above named.',
 lcFootMessage2='I, the undersigned County Clerk of the above named county, do hereby certify that I have received all duplicate receipts, certificates and deposit slips, and the original of all Warrants and Vouchers with duplicate checks thereto attached, as required by law, as shown by the above and foregoing report (except as to depostis and with-drawals of official depository money), and I further certity that the Treasurer''s original report for the day of           ,     , is a duplicate of the above and forgoing.',
 lcBoxColor=14539482,
 tr(
 lcColOffset=0,
  landscape,
  box(450,250,4000,750,6,lcBoxColor),
  prn(gcCounty&' COUNTY TREASURER',1500,300,lcHeaderFontSize-2,,lcFont),
  prn(gcOfficial,1500,500),
  prn(printed,,300),
  prn(page,,300),
  prn(,lcRm,600,lcHeaderFontSize,bold,lcFont),
  bnd(,'COUNTY TREASURER DAILY REPORT',8500C),
  prn(,,,lcHeaderFontSize,bold,lcFont),
  bnd(,format(gcStartDate,@d2)&' - '&format(gcStartDate+gcDays,@d2),8500C),
  prn(,,,6,regular),
  txt(lcMessage,450,900,11000,1000,0),
  lcDetStart=choose(curpag=1,1200,1350),
  prn(,500,lcDetStart,,,lcFont),
 lcLy=lcDetStart,lcRy=lcDetStart,
  det(gcSql4790a),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5200,pagey+128,0,lcBoxColor),bnd(,obj5:a1,2800,obj5:a5,-650,obj5:a6,-950)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,left(obj5:a1,23),1500,obj5:a2,1200,obj5:a5,-550,obj5:a6,-950)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+600,,8,bold,'courier new'),bnd('O',obj5:a1,1500,obj5:a2,1200,obj5:a5,-550,obj5:a6,-950),nl),
   if(lcRowType='grandTotal'),do(nl,prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,1600,obj5:a2,1200,obj5:a5,-550,obj5:a6,-950)),
   edt, 
 lcLy=pagey,
 prn(,5500,1200,,,lcFont),
 lcColOffset=5000,
 det(gcSql4790b),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5600,pagey+128,0,lcBoxColor),bnd(,obj5:a1,3200,obj5:a5,-700,obj5:a6,-950)),
   if(lcRowType='gHeader'),do(prn(,lcColOffset+600,,8,bold,'courier new'),bnd('U',left(obj5:a1,24),1800,obj5:a2,1200,obj5:a5,-700,obj5:a6,-950)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,left(obj5:a1,24),1800,obj5:a2,1200,obj5:a5,-700,obj5:a6,-950)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+600,,8,bold,'courier new'),bnd('O',,300,obj5:a1,1400,obj5:a2,1200,obj5:a5,-700,obj5:a6,-950)),
   if(lcRowType='grandTotal'),do(nl,prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,1950,obj5:a2,1200,obj5:a5,-700,obj5:a6,-950)),
  edt, 
 lcRy=pagey,
 lcColOffset=5000,
 prn(,,lcRy),
  det(gcSql4790v),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5050,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,,8,bold,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt, 
 lcRy=pagey,
 lcColOffset=5000,
 prn(,,lcRy),
  det(gcSql4790tc),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5050,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,,8,bold,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt, 
 lcRy=pagey,
 lcColOffset=5000,
 prn(,,lcRy),
  det(gcSql4790cv),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5050,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,,8,bold,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt, 
 lcRy=pagey,
 lcColOffset=0,
  prn(,,lcLy),
  det(gcSql4790w),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5200,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,bold,8,,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(prn(,lcColOffset+600),bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt,
 lcLy=pagey,
 lcColOffset=0,
  prn(,,lcLy),
  det(gcSql4790m),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5200,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,bold,8,,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(prn(,lcColOffset+600),bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt, 
  lcLy=pagey,
  prn(,,lcLy),
  det(gcSql4790md),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5200,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,,8,bold,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt,
 lcLy=pagey,
 lcColOffset=5000,
 prn(,,lcRy),
  det(gcSql4790c),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5450,pagey+128,0,lcBoxColor),bnd(,obj5:a1,3200,obj5:a5,-700,obj5:a6,-800)),
   if(lcRowType='sjHeader'),do(prn(,lcColOffset+600,,9,bold,'courier new'),bnd('O',,4750),bnd('U',,150,obj5:a1,4550)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,left(obj5:a1,27),1800,obj5:a2,1200,obj5:a5,-700,obj5:a6,-800)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,,8,bold,'courier new'),bnd('O',obj5:a1,1200,obj5:a2,1400,obj5:a5,-700,obj5:a6,-800)),
   if(lcRowType='grandTotal'),do(bnd('O',,4750),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,1750,obj5:a2,1400,obj5:a5,-700,obj5:a6,-800)),
  edt,
 
  if(pagey+0>7150),do(pagebreak,lcy=1200),
  prn(,,,6,regular,lcFont),
  txt(lcFootMessage,450,lcFootY-200,5250,1000,0),  
  prn(,450,,6,regular,lcFont),
  nl,
  bnd('U','County Treasurer:',2500,'Deputy:',2000),
  nl,
  bnd('U','Subscribed and sworn to before me this                   day of                              ,                          .',3450),
  nl,
  bnd('U','County Clerk:',2500),

  txt(lcFootMessage2,5700,lcFootY-200,5250,1000,0),  
  prn(,5700,,6,regular,lcFont),
  nl,
  bnd('U','Received and filed by me this                   day of                              ,                          .',3075),
  nl,
  bnd('U','Deputy:',2500),
  nl,
  bnd('U','County Clerk:',2500),
 );

@printPaidWarrantSummary=
 do(4506,getSiteInfo=),
 d1select('select case when settingvalue = ''TRUE'' then ''Warrant'' else ''Treasurers Check|Paid Warrant'' end from settings where settingname=''site.warrantsHitLedgerWhenRegistered'''),
 lcwarrantCode=obj7:d1,
 lcRm=1200,
 lcCw=750,
 lcAw=(lcCw*4)+400,
 lcFont='Arial',
 lcHeaderFontSize=10,
 lcFootY=7400,
 gcSql4790w='select ltrim(rowstring1), sourceNo, sourceAmt, rowType from dbo.dailydataPayments('''&lcwarrantCode&''',''Fund'','&gcStartDate&','&gcDays&',''A'',''11111'') where rowType in (''detail'',''sHeader'',''gFooter'',''grandTotal'') order by ord',
 lcBoxColor=14539482,
 tr(
 lcColOffset=0,
  box(450,250,4000,750,6,lcBoxColor),
  prn(gcCounty&' COUNTY TREASURER',1500,300,lcHeaderFontSize-2,,lcFont),
  prn(gcOfficial,1500,500),
  prn(printed,,300),
  prn(page,,300),
  prn(,lcRm,800,lcHeaderFontSize,bold,lcFont),
  bnd(,'DAILY REPORT - PAID WARRANT SUMMARY',6000C),
  prn(,,,lcHeaderFontSize,bold,lcFont),
  bnd(,format(gcStartDate,@d2),6000C),
  prn(,,,6,regular),
  txt(lcMessage,450,900,11000,1000,0),
  lcDetStart=choose(curpag=1,1200,1350),
  prn(,500,lcDetStart,,,lcFont),
 lcLy=lcDetStart,lcRy=lcDetStart,
  det(gcSql4790w),
   lcRowType=obj5:a4,
   if(lcRowType='sHeader'),do(prn(,lcColOffset+500,,9,bold,'courier new'),nl,box(lcColOffset+400,pagey-7,lcColOffset+5200,pagey+128,0,lcBoxColor),bnd(,obj5:a1,4500)),
   if(lcRowType='detail'),do(prn(,lcColOffset+600,,8,regular,'courier new'),bnd(,obj5:a1,2300,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='gFooter'),do(prn(,lcColOffset+1000,bold,8,,'courier new'),bnd('O',obj5:a1,1900,obj5:a2,1400,obj5:a3,-500)),
   if(lcRowType='grandTotal'),do(prn(,lcColOffset+600),bnd('O',,4400),prn(,lcColOffset+500,,9,bold,'courier new'),bnd(,obj5:a1,2450,obj5:a2,1400,obj5:a3,-500)),
  edt,
 );
